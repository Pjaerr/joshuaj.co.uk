<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.5f172882cbe3d7c32a31.css">code[class*=language-],pre[class*=language-]{color:#1e272e;font-family:Fira Mono,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;color:#1e272e}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8ca6a6}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol{color:#0094f0}.token.selector,.token.tag{color:#e64100}.token.builtin,.token.char,.token.inserted,.token.string,.token.url{color:#00b368}.token.attr-name{color:#a88c00}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword,.token.operator{color:#ff5792}.token.class-name,.token.function{color:#00bdd6}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}body.dark code[class*=language-],body.dark pre[class*=language-]{color:#f8f8f2;text-shadow:0 1px rgba(0,0,0,.3);font-family:Fira Mono,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.35;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}body.dark pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:0;border:0}body.dark :not(pre)>code[class*=language-],body.dark pre[class*=language-]{background:#223545}body.dark :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;color:#c7ecee}body.dark .prism-show-language{background:#1f4662;border-top:2px solid #ffc600;text-align:right;padding:5px;color:#fff;font-size:11px}body.dark .prism-show-language+pre{margin-top:0}body.dark .token.cdata,body.dark .token.comment,body.dark .token.doctype,body.dark .token.prolog{color:#08f}body.dark .token.comment,body.dark .token.italic{font-style:italic}body.dark .token.punctuation{color:#f8f8f2}body.dark .namespace{opacity:.7}body.dark .token.constant,body.dark .token.deleted,body.dark .token.property,body.dark .token.symbol,body.dark .token.tag{color:#f92672}body.dark .token.boolean,body.dark .token.number{color:#ff628c}body.dark .token.attr-name,body.dark .token.builtin,body.dark .token.char,body.dark .token.inserted,body.dark .token.selector,body.dark .token.string{color:#3ad900}body.dark .language-css .token.string,body.dark .style .token.string,body.dark .token.entity,body.dark .token.operator,body.dark .token.url,body.dark .token.variable{color:#f8f8f2}body.dark .token.atrule,body.dark .token.attr-value{color:#ffc600}body.dark .token.keyword.keyword-function{color:#ffa5f3;background:#1d3c52;padding:4px 2px}body.dark .token.keyword,body.dark .token.operator{color:#ff9d00}body.dark .token.class-name,body.dark .token.function,body.dark .token.keyword.keyword-const,body.dark .token.keyword.keyword-let,body.dark .token.keyword.keyword-var{color:#ffc600}body.dark .token.important,body.dark .token.regex{color:#fd971f}body.dark .token.bold,body.dark .token.important{font-weight:700}body.dark .token.entity{cursor:help}body.dark .language-css .token.boolean,body.dark .language-css .token.number,body.dark .token.hexcode,body.dark code.language-css{color:#edf080}body.dark .language-css .token.selector{color:#9effff}body.dark .language-css .token.attribute,body.dark .language-css .token.class,body.dark .language-css .token.selector .token.class{color:#3ad900}body.dark .language-css .token.property{color:#9df39f}body.dark .token.pseudo-class{color:#ff9a1a}body.dark .language-markup .token.tag,body.dark .token.doctype{color:#9effff}body.dark .language-markup .attr-name{color:#ffc600;font-style:italic}body.dark .language-markup .attr-value{color:#3ad900}body.dark .language-markdown .title{background:#000;color:#fdc500}body.dark .language-markdown .url{color:#3ad900}body.dark .language-markdown .list.punctuation{color:#ff9a1a}body.dark .language-json .property{color:#3ad900}body.dark .language-json .operator{color:#f8f8f2}body.dark code.language-scss{color:#e68885}body.dark .language-scss .property{color:#80ffbb}body.dark .language-scss .keyword{color:#ff9a1a}body.dark .language-scss .token.variable{color:#ccc}body.dark .language-scss .hexcode{color:#f85b79}body.dark .language-scss .function{color:#fff}.GithubIssueComments-container{display:flex;flex-direction:column;width:100%;font-size:.8em;margin-top:20px;margin-bottom:20px}@media (min-width:480px){.GithubIssueComments-container{font-size:1em}}.GithubIssueComments-comment{display:flex;flex-direction:row;margin-top:10px;margin-bottom:20px}.GithubIssueComments-comment-user-avatar{width:20px;height:20px;margin-right:5px}@media (max-width:380px){.GithubIssueComments-comment-user-avatar{display:none}}@media (min-width:480px){.GithubIssueComments-comment-user-avatar{width:40px;height:40px;margin-right:10px}}.GithubIssueComments-comment-user-avatar>img{width:100%;height:100%;border-radius:3px;-o-object-fit:cover;object-fit:cover}.GithubIssueComments-comment-box{border:1px solid rgba(149,157,165,.5);border-radius:3px;color:#24292e;width:100%;overflow:hidden}.GithubIssueComments-comment-box-header{border-bottom:1px solid rgba(149,157,165,.5);background-color:#f6f8fa;height:34px;display:flex;justify-content:flex-start;align-items:center;padding:.5rem}.GithubIssueComments-comment-box-header-isOwner{background-color:#f1f8ff}.GithubIssueComments-comment-box-header-username{font-weight:700}.GithubIssueComments-comment-box-header-username>span{font-weight:400;color:#586069}.GithubIssueComments-comment-box-body{background-color:#fff;padding:.8rem}.GithubIssueComments-comment-box-body>p{overflow-wrap:break-word}.GithubIssueComments-comment-box-body>p>blockquote{margin:0;padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.GithubIssueComments-comment-box-body>p pre,code{overflow-x:auto}.GithubIssueComments-new-comment-button{display:flex;justify-content:center;align-items:center;min-width:12rem;min-height:2.5rem;padding-left:.5rem;padding-right:.5rem;margin:10px auto 0;border-radius:3px;background-color:#28a745;color:#fff;text-align:center;font-weight:700;text-decoration:none}.GithubIssueComments-loading-icon{width:40px;height:40px;background-color:#6a737d;margin:30px auto 0;animation:sk-rotateplane 1.5s ease-in-out infinite}@keyframes sk-rotateplane{0%{transform:perspective(120px) rotateX(0deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg)}50%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg)}to{transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)}}.GithubIssueComments-no-comments-found{display:flex;justify-content:center;align-items:center;padding:1rem}.GithubIssueComments-show-comments-button{display:flex;justify-content:center;align-items:center;margin:0 auto;width:12rem;height:2.5rem;padding-left:.5rem;padding-right:.5rem;border:1px solid #586069;border-radius:3px;background-color:#fff;color:#586069;transition:background-color .3s cubic-bezier(.4,0,.2,1)}.GithubIssueComments-show-comments-button:hover{background-color:#586069;color:#fff}.GithubIssueComments-refresh-comments-button{border:none;background:none;display:flex;justify-content:center;align-items:center;color:#586069;text-decoration:underline;font-size:.8em;margin:20px auto 15px}.GithubIssueComments-refresh-comments-button:hover{cursor:pointer}.GithubIssueComments-refresh-comments-button:disabled{text-decoration:none;transition:opacity .2s ease-in-out;opacity:.2}.GithubIssueComments-pagination{display:flex;justify-content:center;flex-wrap:wrap;padding:1rem}.GithubIssueComments-pagination-button{border:none;background:none;color:#586069;margin-bottom:.5rem}.GithubIssueComments-pagination-button:hover{cursor:pointer}.GithubIssueComments-pagination-button-active{text-decoration:underline;font-weight:700}body.dark .GithubIssueComments-comment-box{border:none;color:#24292e}body.dark .GithubIssueComments-comment-box-body,body.dark .GithubIssueComments-loading-icon{background-color:#fff}body.dark .GithubIssueComments-show-comments-button{border:1px solid #fff;background-color:transparent;color:#fff}body.dark .GithubIssueComments-show-comments-button:hover{background-color:#fff;color:#586069}body.dark .GithubIssueComments-pagination-button,body.dark .GithubIssueComments-refresh-comments-button{color:#fff}</style><meta name="generator" content="Gatsby 2.20.15"/><title data-react-helmet="true">Introduction to Websockets | Josh Jackson - @Pjaerr</title><meta data-react-helmet="true" name="description" content="In this blogpost I will be covering the basics of websockets by creating a website using HTML, CSS, JavaScript and Node.js that allows users to paint on a canvas with other users in realtime."/><meta data-react-helmet="true" property="og:title" content="Introduction to Websockets"/><meta data-react-helmet="true" property="og:description" content="In this blogpost I will be covering the basics of websockets by creating a website using HTML, CSS, JavaScript and Node.js that allows users to paint on a canvas with other users in realtime."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://joshuaj.co.uk/introduction-to-websockets/cover_image.jpg"/><meta data-react-helmet="true" name="twitter:image" content="https://joshuaj.co.uk/introduction-to-websockets/cover_image.jpg"/><meta data-react-helmet="true" property="og:image:width" content="1200"/><meta data-react-helmet="true" property="og:image:height" content="630"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@Pjaerr"/><meta data-react-helmet="true" name="twitter:title" content="Introduction to Websockets"/><meta data-react-helmet="true" name="twitter:description" content="In this blogpost I will be covering the basics of websockets by creating a website using HTML, CSS, JavaScript and Node.js that allows users to paint on a canvas with other users in realtime."/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="alternate" type="application/rss+xml" title="Josh Jackson - @Pjaerr | RSS Feed" href="/rss.xml"/><style data-styled="" data-styled-version="5.1.0">.fuyTsK{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:40px;margin-bottom:40px;margin-left:-10%;width:calc(100% + (10% * 2));}/*!sc*/
@media (min-width:768px){.fuyTsK{margin-left:0;margin-right:0;width:100%;}}/*!sc*/
.fuyTsK video{max-width:100%;margin-bottom:10px;}/*!sc*/
.fuyTsK figcaption{font-family:"Fira Mono";font-size:0.875em;}/*!sc*/
data-styled.g1[id="Video__VideoContainer-ugyrsd-0"]{content:"fuyTsK,"}/*!sc*/
.hTxBiT{-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px);-webkit-transition-property:background-color,color;transition-property:background-color,color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;background-color:initial;position:absolute;top:0;left:0;bottom:0;right:0;z-index:10;padding:0;display:grid;grid-template-rows:auto 1fr;grid-row-gap:20px;}/*!sc*/
@media (min-width:768px){.hTxBiT{-webkit-transform:translateX(0px);-ms-transform:translateX(0px);transform:translateX(0px);-webkit-transition:background-color 0s ease-out;transition:background-color 0s ease-out;background-color:initial;position:relative;grid-template-rows:1fr;grid-template-columns:1fr 1fr;padding:20px 10% 20px 10%;}}/*!sc*/
data-styled.g7[id="NavigationStyles__Nav-nyoyvp-0"]{content:"hTxBiT,"}/*!sc*/
.qlJep{display:grid;grid-template-columns:1fr auto;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transform:translateY(2000px);-ms-transform:translateY(2000px);transform:translateY(2000px);-webkit-transition:-webkit-transform 0s ease-in;-webkit-transition:transform 0s ease-in;transition:transform 0s ease-in;padding:20px 10% 20px 10%;}/*!sc*/
.qlJep a{justify-self:start;font-size:1.125em;-webkit-text-decoration:underline;text-decoration:underline;font-weight:bold;color:var(--colour-text-heading);font-weight:bold;}/*!sc*/
.qlJep a:hover{color:var(----colour-highlight);}/*!sc*/
.qlJep button{justify-self:end;background:none;outline:none;border:none;width:48px;height:48px;position:relative;cursor:pointer;}/*!sc*/
.qlJep button svg{width:32px;height:32px;fill:var(--colour-text-heading);}/*!sc*/
@media (min-width:768px){.qlJep{-webkit-transform:translateX(0px);-ms-transform:translateX(0px);transform:translateX(0px);grid-template-columns:1fr;grid-template-rows:auto;-webkit-box-pack:start;-webkit-justify-content:start;-ms-flex-pack:start;justify-content:start;padding:0;}.qlJep button{display:none;}.qlJep a{color:var(--colour-text-heading);}.qlJep a:hover{color:var(--colour-highlight);}}/*!sc*/
data-styled.g8[id="NavigationStyles__NavHeader-nyoyvp-1"]{content:"qlJep,"}/*!sc*/
.gJBdJ{display:none;grid-template-rows:3fr 1fr;grid-row-gap:25px;}/*!sc*/
.gJBdJ ul{display:grid;grid-template-rows:auto auto auto;grid-row-gap:25px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;list-style:none;margin:0;padding:0;}/*!sc*/
.gJBdJ ul li{margin:0 auto;}/*!sc*/
.gJBdJ ul li a{font-size:1.875em;color:var(--colour-mobile-menu-text);font-weight:bold;}/*!sc*/
.gJBdJ ul li a:hover{color:var(--colour-mobile-menu-text-hover);}/*!sc*/
.gJBdJ ul li a svg{fill:var(--colour-mobile-menu-text);}/*!sc*/
.gJBdJ ul li a svg:hover{fill:var(--colour-mobile-menu-text-hover);}/*!sc*/
@media (min-width:768px){.gJBdJ{display:grid;grid-template-columns:auto auto;grid-template-rows:auto;grid-column-gap:50px;-webkit-box-pack:end;-webkit-justify-content:end;-ms-flex-pack:end;justify-content:end;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.gJBdJ ul{grid-template-columns:1fr 1fr 1fr;grid-column-gap:25px;grid-row-gap:0;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.gJBdJ ul li a{font-size:1.125em;color:var(--colour-text-heading);font-weight:bold;}.gJBdJ ul li a:hover{color:var(--colour-highlight);}.gJBdJ ul li a svg{fill:var(--colour-text-heading);width:32px;height:32px;}.gJBdJ ul li a svg:hover{fill:var(--colour-highlight);}}/*!sc*/
data-styled.g9[id="NavigationStyles__NavLinks-nyoyvp-2"]{content:"gJBdJ,"}/*!sc*/
.NPmAf{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;justify-self:center;}/*!sc*/
.NPmAf:hover{cursor:pointer;}/*!sc*/
.NPmAf input{-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;}/*!sc*/
@media (min-width:768px){.NPmAf{margin-bottom:5px;}}/*!sc*/
data-styled.g10[id="NavigationStyles__ThemeSwitcherLabel-nyoyvp-3"]{content:"NPmAf,"}/*!sc*/
.bmmJQH:before{background-color:var(--colour-text-heading);-webkit-transition:-webkit-transform 0.2s ease-in;-webkit-transition:transform 0.2s ease-in;transition:transform 0.2s ease-in;content:"";width:26px;height:5px;margin-top:-2.5px;display:inline-block;}/*!sc*/
.bmmJQH:after{background-color:var(--colour-text-heading);-webkit-transition:-webkit-transform 0.25s ease-in;-webkit-transition:transform 0.25s ease-in;transition:transform 0.25s ease-in;content:"";width:26px;height:5px;margin-top:-2.5px;display:inline-block;}/*!sc*/
data-styled.g11[id="NavigationStyles__MenuIcon-nyoyvp-4"]{content:"bmmJQH,"}/*!sc*/
.ljjsYD{fill:var(--colour-text-body);}/*!sc*/
.ljjsYD:hover{fill:var(----colour-highlight);}/*!sc*/
.Gzdxf{fill:var(--colour-text-body);}/*!sc*/
data-styled.g12[id="SVGIcon__SVG-sc-1rlxxk7-0"]{content:"ljjsYD,Gzdxf,"}/*!sc*/
.hZSfqs{position:fixed;top:0;z-index:1;width:100%;height:4px;}/*!sc*/
.hZSfqs div{height:4px;background:var(--colour-highlight);width:0%;}/*!sc*/
data-styled.g13[id="ScrollProgressBar__Container-hiuh85-0"]{content:"hZSfqs,"}/*!sc*/
.bpXHJg{margin-top:40px;margin-bottom:40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
.bpXHJg p{font-weight:bold;text-align:center;font-size:1.125em;}/*!sc*/
@media (min-width:768px){.bpXHJg p{font-size:1.25em;}}/*!sc*/
data-styled.g14[id="BlogpostEnd__Container-sc-1v5rsh7-0"]{content:"bpXHJg,"}/*!sc*/
.deHjxH{max-width:100%;}/*!sc*/
@media (min-width:980px){.deHjxH{max-width:50em;}}/*!sc*/
data-styled.g15[id="BlogPostTemplateStyles__BlogpostContainer-hcbxnd-0"]{content:"deHjxH,"}/*!sc*/
.cMnxBp{font-size:1.563em;}/*!sc*/
@media (min-width:480px){.cMnxBp{font-size:2.813em;}}/*!sc*/
data-styled.g16[id="BlogPostTemplateStyles__BlogpostTitle-hcbxnd-1"]{content:"cMnxBp,"}/*!sc*/
.gqLktq{margin-bottom:35px;}/*!sc*/
@media (min-width:768px){.gqLktq{margin-bottom:70px;}}/*!sc*/
data-styled.g17[id="BlogPostTemplateStyles__BlogpostDate-hcbxnd-2"]{content:"gqLktq,"}/*!sc*/
.hBveAO{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-weight:normal;width:100%;max-width:100%;}/*!sc*/
.hBveAO h1,.hBveAO h2,.hBveAO h3,.hBveAO h4,.hBveAO h5{font-weight:bold;}/*!sc*/
.hBveAO h2{margin-top:40px;margin-bottom:20px;font-size:1.375em;}/*!sc*/
@media (min-width:980px){.hBveAO h2{font-size:1.563em;}}/*!sc*/
.hBveAO .heading-link-icon{margin-right:10px;}/*!sc*/
.hBveAO p{font-size:1.125em;max-width:100%;word-break:break-word;line-height:30px;}/*!sc*/
@media (min-width:768px){.hBveAO p{font-size:1.25em;}}/*!sc*/
.hBveAO h1::selection,.hBveAO h2::selection,.hBveAO h3::selection,.hBveAO h4::selection,.hBveAO h5::selection,.hBveAO p::selection,.hBveAO em::selection,.hBveAO b::selection{color:var(--colour-background);background-color:var(--colour-text-heading);}/*!sc*/
.hBveAO a{font-weight:bold;-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.hBveAO code{overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;}/*!sc*/
.hBveAO .gatsby-code-title{background-color:var(--colour-code-title);color:var(--colour-text-body);padding-top:0.5em;text-align:center;padding-bottom:0.5em;margin-bottom:-8px;margin-top:20px;border-top-left-radius:0.3em;border-top-right-radius:0.3em;margin-left:-10%;width:calc(100% + (10% * 2));}/*!sc*/
@media (min-width:768px){.hBveAO .gatsby-code-title{margin-left:0;margin-right:0;width:100%;}}/*!sc*/
.hBveAO .gatsby-highlight{font-weight:500;margin-bottom:20px;margin-left:-10%;width:calc(100% + (10% * 2));}/*!sc*/
@media (min-width:768px){.hBveAO .gatsby-highlight{margin-left:0;margin-right:0;width:100%;}}/*!sc*/
.hBveAO .gatsby-highlight pre{border-radius:0;}/*!sc*/
.hBveAO .gatsby-highlight pre code{white-space:pre-wrap;word-wrap:break-word;}/*!sc*/
.hBveAO .gatsby-highlight-code-line{width:100%;background-color:var(--colour-code-highlight);display:block;padding-right:1em;padding-left:0.75em;margin-left:-1em;border-left:0.25em solid var(--colour-code-highlight-sidebar);}/*!sc*/
.hBveAO ul,.hBveAO ol{list-style:none;padding-left:0;max-width:100%;}/*!sc*/
.hBveAO ul li,.hBveAO ol li{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:baseline;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;line-height:32px;margin-bottom:25px;font-size:1.125em;}/*!sc*/
@media (min-width:768px){.hBveAO ul li,.hBveAO ol li{font-size:1.25em;}}/*!sc*/
.hBveAO ul li p,.hBveAO ol li p{display:inline;font-size:inherit;}/*!sc*/
.hBveAO ul li *,.hBveAO ol li *{margin-right:4px;margin-left:4px;}/*!sc*/
.hBveAO ul li::before{content:"ê˜Ž";padding-right:16px;color:var(--colour-highlight);font-size:1.25em;font-weight:bold;}/*!sc*/
.hBveAO ol{counter-reset:list-number;}/*!sc*/
.hBveAO ol li{counter-increment:list-number;}/*!sc*/
.hBveAO ol li::before{content:counter(list-number) ".";padding-right:16px;color:var(--colour-highlight);font-size:1.25em;font-style:italic;font-weight:bold;}/*!sc*/
data-styled.g18[id="BlogPostTemplateStyles__BlogpostContent-hcbxnd-3"]{content:"hBveAO,"}/*!sc*/
body,html{margin:0;padding:0;border:0;font-family:"IBM Plex Sans",sans-serif;}/*!sc*/
body{--colour-background:#fff;--colour-text-heading:#2a2f36;--colour-text-body:#353b48;--colour-highlight:#0097A7;--colour-mobile-menu-background:rgba(1,163,164,0.99);--colour-mobile-menu-text:#fff;--colour-mobile-menu-text-hover:#2a2f36;--colour-code-highlight:#feb;--colour-code-highlight-sidebar:#f99;--colour-code-title:#F5F6FA;font-weight:500;background-color:var(--colour-background);color:var(--colour-text-body);-webkit-transition-property:background-color,color;transition-property:background-color,color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;font-size:1em;}/*!sc*/
body.dark{--colour-background:#282c35;--colour-text-heading:#fff;--colour-text-body:#dcdde1;--colour-highlight:#01cbcb;--colour-mobile-menu-background:rgba(63,67,77,0.99);--colour-mobile-menu-text-hover:rgba(1,163,164,0.99);--colour-code-highlight:#1e2f3e;--colour-code-highlight-sidebar:#fbc531;--colour-code-title:#576574;}/*!sc*/
html.menu-open,body.menu-open{height:100%;overflow:hidden;}/*!sc*/
h1,h2,h3,h4,h5{margin:0;color:var(--colour-text-heading);}/*!sc*/
a{color:var(--colour-highlight);-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.25s ease;transition:color 0.25s ease;}/*!sc*/
a:hover{color:var(--colour-text-body);}/*!sc*/
main{margin-left:10%;margin-right:10%;margin-bottom:120px;}/*!sc*/
@media (min-width:768px){main.blogpost-layout{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}/*!sc*/
.layout-header{height:120px;}/*!sc*/
data-styled.g31[id="sc-global-ayxrs1"]{content:"sc-global-ayxrs1,"}/*!sc*/
</style><link rel="icon" href="/icons/icon-48x48.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#01a3a4"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9b37d5638b56c95b9c1f5534c17bba5f"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/firamono/v8/N0bS2SlFPv1weGeLZDto1d3HnvfU.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/firamono/v8/N0bS2SlFPv1weGeLZDtondvHnvfU.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjSL9AIFsdA.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjWr7AIFsdA.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/ibmplexsans/v7/zYXgKVElMYYaJe8bpLHnCwDKhdHeFQ.woff2"/><style type="text/css">@font-face{font-family:'IBM Plex Sans';font-style:normal;font-weight:400;src:local('IBM Plex Sans'),local('IBMPlexSans'),url(/google-fonts/s/ibmplexsans/v7/zYXgKVElMYYaJe8bpLHnCwDKhdHeFQ.woff2) format('woff2'),url(/google-fonts/s/ibmplexsans/v7/zYXgKVElMYYaJe8bpLHnCwDKhdHeEw.woff) format('woff');font-display: swap;}@font-face{font-family:'IBM Plex Sans';font-style:normal;font-weight:500;src:local('IBM Plex Sans Medium'),local('IBMPlexSans-Medium'),url(/google-fonts/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjSL9AIFsdA.woff2) format('woff2'),url(/google-fonts/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjSL9AIFscg.woff) format('woff');font-display: swap;}@font-face{font-family:'IBM Plex Sans';font-style:normal;font-weight:700;src:local('IBM Plex Sans Bold'),local('IBMPlexSans-Bold'),url(/google-fonts/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjWr7AIFsdA.woff2) format('woff2'),url(/google-fonts/s/ibmplexsans/v7/zYX9KVElMYYaJe8bpLHnCwDKjWr7AIFscg.woff) format('woff');font-display: swap;}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:500;src:local('Fira Mono Medium'),local('FiraMono-Medium'),url(/google-fonts/s/firamono/v8/N0bS2SlFPv1weGeLZDto1d3HnvfU.woff2) format('woff2'),url(/google-fonts/s/firamono/v8/N0bS2SlFPv1weGeLZDto1d3HnvfS.woff) format('woff');font-display: swap;}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:700;src:local('Fira Mono Bold'),local('FiraMono-Bold'),url(/google-fonts/s/firamono/v8/N0bS2SlFPv1weGeLZDtondvHnvfU.woff2) format('woff2'),url(/google-fonts/s/firamono/v8/N0bS2SlFPv1weGeLZDtondvHnvfS.woff) format('woff');font-display: swap;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  window.excludeGAPaths=[/^(?:\/)$/];
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-146439931-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-146439931-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link as="script" rel="preload" href="/styles-1bb458fe328f2ce5df8e.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-template-js-ab5ceb8031054a06af97.js"/><link as="script" rel="preload" href="/a41fe35e98afd0b1499457e30a7a2f454f628b37-ca9d42fee389d0cce62e.js"/><link as="script" rel="preload" href="/framework-37b45856124a722f0eb5.js"/><link as="script" rel="preload" href="/app-26b0f76e619f0f82c78b.js"/><link as="script" rel="preload" href="/webpack-runtime-d1be503a8acc3e14dd04.js"/><link as="fetch" rel="preload" href="/page-data\blog\introduction-to-websockets\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="layout-header"><nav class="NavigationStyles__Nav-nyoyvp-0 hTxBiT"><div class="NavigationStyles__NavHeader-nyoyvp-1 qlJep"><a href="/">Josh Jackson</a><button aria-label="toggle mobile menu"><span class="NavigationStyles__MenuIcon-nyoyvp-4 bmmJQH"></span></button></div><div class="NavigationStyles__NavLinks-nyoyvp-2 gJBdJ"><ul><li><a aria-label="visit my github page" href="https://github.com/pjaerr" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="48" height="48" viewBox="0 0 24 24" class="SVGIcon__SVG-sc-1rlxxk7-0 ljjsYD"><path d="M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H14.56C14.24,20.93 14.23,20.32 14.23,20.11L14.24,17.64C14.24,16.8 13.95,16.25 13.63,15.97C15.64,15.75 17.74,15 17.74,11.53C17.74,10.55 17.39,9.74 16.82,9.11C16.91,8.89 17.22,7.97 16.73,6.73C16.73,6.73 15.97,6.5 14.25,7.66C13.53,7.46 12.77,7.36 12,7.35C11.24,7.36 10.46,7.46 9.75,7.66C8.03,6.5 7.27,6.73 7.27,6.73C6.78,7.97 7.09,8.89 7.18,9.11C6.61,9.74 6.26,10.55 6.26,11.53C6.26,15 8.36,15.75 10.36,16C10.1,16.2 9.87,16.6 9.79,17.18C9.27,17.41 7.97,17.81 7.17,16.43C7.17,16.43 6.69,15.57 5.79,15.5C5.79,15.5 4.91,15.5 5.73,16.05C5.73,16.05 6.32,16.33 6.73,17.37C6.73,17.37 7.25,19.12 9.76,18.58L9.77,20.11C9.77,20.32 9.75,20.93 9.43,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3Z"></path></svg></a></li><li><a aria-label="visit my linkedin profile" href="https://www.linkedin.com/in/joshua-jackson-53b9bb14b/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="48" height="48" viewBox="0 0 24 24" class="SVGIcon__SVG-sc-1rlxxk7-0 ljjsYD"><path d="M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19M18.5,18.5V13.2A3.26,3.26 0 0,0 15.24,9.94C14.39,9.94 13.4,10.46 12.92,11.24V10.13H10.13V18.5H12.92V13.57C12.92,12.8 13.54,12.17 14.31,12.17A1.4,1.4 0 0,1 15.71,13.57V18.5H18.5M6.88,8.56A1.68,1.68 0 0,0 8.56,6.88C8.56,5.95 7.81,5.19 6.88,5.19A1.69,1.69 0 0,0 5.19,6.88C5.19,7.81 5.95,8.56 6.88,8.56M8.27,18.5V10.13H5.5V18.5H8.27Z"></path></svg></a></li><li><a aria-label="visit my twitter profile" href="https://twitter.com/Pjaerr" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="48" height="48" viewBox="0 0 24 24" class="SVGIcon__SVG-sc-1rlxxk7-0 ljjsYD"><path d="M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M17.71,9.33C18.19,8.93 18.75,8.45 19,7.92C18.59,8.13 18.1,8.26 17.56,8.33C18.06,7.97 18.47,7.5 18.68,6.86C18.16,7.14 17.63,7.38 16.97,7.5C15.42,5.63 11.71,7.15 12.37,9.95C9.76,9.79 8.17,8.61 6.85,7.16C6.1,8.38 6.75,10.23 7.64,10.74C7.18,10.71 6.83,10.57 6.5,10.41C6.54,11.95 7.39,12.69 8.58,13.09C8.22,13.16 7.82,13.18 7.44,13.12C7.81,14.19 8.58,14.86 9.9,15C9,15.76 7.34,16.29 6,16.08C7.15,16.81 8.46,17.39 10.28,17.31C14.69,17.11 17.64,13.95 17.71,9.33Z"></path></svg></a></li></ul><label aria-label="toggle light theme" class="NavigationStyles__ThemeSwitcherLabel-nyoyvp-3 NPmAf"><input type="checkbox" class="theme-switcher-checkbox"/><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="36" height="38" viewBox="0 0 24 24" class="SVGIcon__SVG-sc-1rlxxk7-0 Gzdxf"><path d="M20,11H23V13H20V11M1,11H4V13H1V11M13,1V4H11V1H13M4.92,3.5L7.05,5.64L5.63,7.05L3.5,4.93L4.92,3.5M16.95,5.63L19.07,3.5L20.5,4.93L18.37,7.05L16.95,5.63M12,6A6,6 0 0,1 18,12C18,14.22 16.79,16.16 15,17.2V19A1,1 0 0,1 14,20H10A1,1 0 0,1 9,19V17.2C7.21,16.16 6,14.22 6,12A6,6 0 0,1 12,6M14,21V22A1,1 0 0,1 13,23H11A1,1 0 0,1 10,22V21H14M11,18H13V15.87C14.73,15.43 16,13.86 16,12A4,4 0 0,0 12,8A4,4 0 0,0 8,12C8,13.86 9.27,15.43 11,15.87V18Z" fill="#fff"></path></svg></label></div></nav></header><div class="ScrollProgressBar__Container-hiuh85-0 hZSfqs"><div></div></div><main class="blogpost-layout"><article class="BlogPostTemplateStyles__BlogpostContainer-hcbxnd-0 deHjxH"><h1 class="BlogPostTemplateStyles__BlogpostTitle-hcbxnd-1 cMnxBp">Introduction to Websockets</h1><p class="BlogPostTemplateStyles__BlogpostDate-hcbxnd-2 gqLktq">May 29, 2020</p><section class="BlogPostTemplateStyles__BlogpostContent-hcbxnd-3 hBveAO"><p><em>This guide is a brief introduction to websockets and is a precursor to my upcoming tutorial on making a multiplayer quiz game using react and websockets.</em></p><p>In this blogpost I will be covering the basics of websockets by creating a website that allows users to paint on a canvas with other users in realtime. We won&#x27;t be using any frameworks in this post, just normal HTML, CSS and JavaScript with some Node.js for the websocket server.</p><figure class="Video__VideoContainer-ugyrsd-0 fuyTsK"><video autoplay="" playsinline="" loop="" muted="" controls=""><source src="/introduction-to-websockets/finished-website.webm" type="video/webm"/><source src="/introduction-to-websockets/finished-website.mp4" type="video/mp4"/>Sorry, your browser doesn&#x27;t support embedded videos.</video><figcaption>The finished website</figcaption></figure><h3>Prerequisities</h3><p>Before we get started it is assumed that you have a basic knowledge of HTML, CSS and JavaScript and have atleast heard of Node and the Node Package Manager (NPM)</p><h2>Getting Setup</h2><ol><li><p>Create a folder somewhere on your computer: <code class="language-text">mkdir intro-to-websockets</code></p></li><li><p>Inside of that folder, create two more folders named <em>client</em> and <em>server</em>: <code class="language-text">cd intro-to-websockets &amp;&amp; mkdir client &amp;&amp; mkdir server</code></p></li><li><p>Finally, inside of the <em>client</em> folder, create an index.html file and main.js file with the following content:</p></li></ol><div class="gatsby-code-title">client/index.html</div><div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Intro To Websockets<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
      <span class="token selector">html,
      body</span> <span class="token punctuation">{</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
        <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
        <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token selector">canvas</span> <span class="token punctuation">{</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Paint with Friends!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--The &lt;canvas&gt; is what we will be drawing on--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>800<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre></div><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><h3>Serving the files locally</h3><p>During development our website will be communicating with a server (once we implement websockets) and the server will expect the communications to be coming from <em>another</em> server, and not a local file. This means we can&#x27;t just open our <code class="language-text">index.html</code> file in the browser, instead we need to host the file via a local web server.</p><p>This can be done in many ways, one way is to use a node package called <a href="https://www.npmjs.com/package/http-server" target="_blank" rel="nofollow">http-server</a>. You will need Node.js installed for this to work. We&#x27;ll be using Node.js later anyway so you might as well install it now, you can do that <a href="https://nodejs.org/en/" target="_blank" rel="nofollow">here</a>.</p><p>Once you&#x27;ve installed node, you&#x27;ll probably need to restart your terminal <small>(You can check that node is installed by running <code class="language-text">node -v</code>)</small>.</p><p>If node is sucessfully installed, you can use the <code class="language-text">http-server</code> package by navigating to your <code class="language-text">client</code> folder and running <code class="language-text">npx http-server -c-1</code>, this will make your index.html file available when you visit <code class="language-text">http://localhost:8080</code> in your browser.</p><p>To make sure our JavaScript has loaded, open your console (F12) and make sure that &quot;Hello World!&quot; is being printed.</p><h2>Implementing the clientside painting functionality</h2><p>Before we even deal with websockets, we should implement the clientside functionality that allows a user to draw on the screen.</p><p>First, inside of the <em>client/main.js</em> file, start by grabbing the canvas element and the context required to draw to the canvas:</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></div><p>and then set the fill colour, that the canvas will use when we draw, to be a random colour from an array of colours.</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> colours <span class="token operator">=</span> <span class="token punctuation">[</span></span><span class="gatsby-highlight-code-line">  <span class="token string">&quot;#2ecc71&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token string">&quot;#3498db&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token string">&quot;#e74c3c&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token string">&quot;#9b59b6&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token string">&quot;#f39c12&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token string">&quot;#ecf0f1&quot;</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> thisColour <span class="token operator">=</span></span><span class="gatsby-highlight-code-line">  colours<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>colours<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> thisColour<span class="token punctuation">;</span></span></code></pre></div><p>Finally, we store whether the mouse is being clicked by setting <code class="language-text">isMouseDown</code> to true when the &quot;mousedown&quot; event is triggered and false when the &quot;mouseup&quot; event is triggered.</p><p>Then, inside of a &quot;mousemove&quot; event listener, we check if the mouse is currently being clicked and if it is, we draw a rectangle onto the canvas at the current position of the mouse with a width and height of 15:</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> colours <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;#2ecc71&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;#3498db&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;#e74c3c&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;#9b59b6&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;#f39c12&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;#ecf0f1&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> thisColour <span class="token operator">=</span>
  colours<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>colours<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> thisColour<span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">let</span> isMouseDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mousedown&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>isMouseDown <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseup&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>isMouseDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mousemove&quot;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>isMouseDown<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>offsetX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>offsetY<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></div><p>Refresh your browser and try drawing on the canvas to make sure everything works.</p><h2>Setting up a Websocket Server</h2><h3>The general idea</h3><p>Setting up a websocket server isn&#x27;t overly complicated, but can be confusing if you don&#x27;t understand how websockets work so let&#x27;s first cover the basics of websockets and then setup a simple server using Node.js.</p><p>When using websockets, it is key to understand that the clients don&#x27;t directly talk to other clients, rather they have a persistent connection with the server through which they can send and receive messages. The server can then forward their messages onto all of the other clients that are connected.</p><p>Each client can then listen for a message from the server and then do something in response to it. In the context of our website, when our user draws a rectangle on the canvas, we will tell the server where that rectangle has been drawn and then the server will relay that to all of the other clients who will then draw the same rectangle on their canvases.</p><p><img src="/introduction-to-websockets/websockets-client-server-idea" alt="Websockets General Idea Diagram"/></p><p>By default, when a client connects to the websocket server, they send a &quot;connection&quot; message, the clients can then send any messages to the server and the server can also send messages to the client.</p><h3>The Code</h3><p>Let&#x27;s start by setting up the server. For the server we will be using Node.js and a node implementation of the underlying websocket protocol called <a href="https://github.com/websockets/ws" target="_blank" rel="nofollow">ws</a>, for the clientside (which we will get to later on) we will be using websockets that are <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" target="_blank" rel="nofollow">native to the browser</a>.</p><p>Before getting started, make sure you have <a href="https://nodejs.org/en/" target="_blank" rel="nofollow">Node.js</a> installed if you didn&#x27;t do it earlier.</p><ol><li><p>Start by navigating to the <em>server</em> folder in your terminal and run <code class="language-text">npm init -y</code> which allows us to install local node packages using the Node Package Manager (NPM). <small><em>*<!-- -->You&#x27;ll need to stop your web server or open a new terminal</em></small></p></li><li><p>Next, run <code class="language-text">npm install ws</code> to install the ws package.</p></li></ol><p>The <code class="language-text">ws</code> package is now a package that our project depends on, you can see this in your <code class="language-text">package.json</code>.</p><div class="gatsby-code-title">server/package.json</div><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ws&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.3.0&quot;</span>
  <span class="token punctuation">}</span></code></pre></div><p>Next, create a <code class="language-text">main.js</code> file inside of the <em>server</em> folder, this will hold the code for our server. Write the following inside of it:</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ws&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebSocketServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>First we import the node.js <code class="language-text">http</code> module which allows us to start a web server and then we import the <code class="language-text">ws</code> module we installed earlier:</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ws&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebSocketServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>Next we use the <code class="language-text">http</code> module to create and then start a http server on port 1234:</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ws&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token keyword">const</span> WebSocketServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></div><p>finally, we use the <code class="language-text">ws</code> module to create a WebSocket server that sits on top of the http server we just created and then we add a listener that will be triggered when a client connects to it.</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ws&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> WebSocketServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>and that&#x27;s it for a basic websocket server. In the next section we&#x27;ll write the code that allows clients to connect to it.</p><h2>Setting up a Websocket Client</h2><p>So now we&#x27;ve got a server, all that&#x27;s needed is just one line of code to connect to the server.</p><p>At the top of your <em>client/main.js</em> file, put the following:</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:1234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>This line of code connects the client to the server that is at <code class="language-text">ws://localhost:1234</code>. You might be thinking that this looks like a regular URL, and that&#x27;s because it is similar, the only difference is that instead of using the <code class="language-text">http</code> protocol, we are using the <code class="language-text">ws</code> (websocket) protocol which enables two-way communication between a client to a remote server. Similarly to <code class="language-text">https</code>, there is a <code class="language-text">wss</code> protocol which we&#x27;ll cover later on.</p><p>Run your server by navigating to the <em>server</em> folder and running <code class="language-text">node main.js</code>.</p><p>If you stopped your client http-server earlier you can restart it by running <code class="language-text">npx http-server -c-1</code> inside of the <em>client</em> folder. You&#x27;ll need to do this in a seperate terminal from the one running your server.</p><p>Now, when you visit your client on <code class="language-text">http://localhost:8080</code> you should see &quot;New Connection&quot; printed out into the terminal that is running the server.</p><p>That&#x27;s all you need to setup a client -&gt; server connection.</p><h2>Sending Messages from the Client to the Server</h2><p>Let&#x27;s add some code to our server that listens for messages from the clients.</p><p>In the <em>server/main.js</em> file, add the following to the <code class="language-text">WebSocketServer.on</code> listener:</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>This will, when a client connects, add a listener that listens for if they send a message to the server, it will then just console log whatever that message is.</p><p>Now on the client we can write some code that sends a message to the server when the user clicks their mouse.</p><p>Modify the existing event listener:</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mousedown&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isMouseDown <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;Client is clicking their mouse!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>and then restart your server (by cancelling the process and running <code class="language-text">node main.js</code> in the <em>server</em> folder)</p><p>Visit <code class="language-text">http://localhost:8080</code>, refresh the page, and then click anywhere on the page. If you look at the terminal that is running your server <small>(the one you ran <code class="language-text">node main.js</code> in)</small>, you should see &quot;Client is clicking their mouse!&quot; being printed out.</p><p>If you put the terminal and browser side by side and then click, you can see this work in realtime.</p><h3>Making it a bit more realistic</h3><p>So we can tell the server that we&#x27;re clicking, is there any limit to our power?</p><p>Let&#x27;s make it a bit more realistic to our use case by telling the server that we&#x27;re drawing, and let it know where we a drawing on the canvas and what colour we are.</p><p>In the <em>client/main.js</em> file, first remove the <code class="language-text">socket.send</code> we wrote above.</p><p>Then, inside of the &quot;mousemove&quot; event listener, add the following code:</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mousemove&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isMouseDown<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>offsetX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>offsetY<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">    socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span></span><span class="gatsby-highlight-code-line">      <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">        x<span class="token operator">:</span> e<span class="token punctuation">.</span>offsetX<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">        y<span class="token operator">:</span> e<span class="token punctuation">.</span>offsetY<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">        colour<span class="token operator">:</span> thisColour<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>This sends a string of JSON to the server whenever we draw on the canvas, this string just tells the server where on the canvas we drew (x, y) and what the colour of our client is.</p><p>Now, in the server code, we can edit our message listener to print out the more detailed message:</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> colour <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="gatsby-highlight-code-line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Client is drawing at (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) with the colour: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>colour<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>Here we just parse the JSON so it can be used as a normal JavaScript object, we then <a href="https://wesbos.com/destructuring-objects" target="_blank" rel="nofollow">destructure</a> the object to pull out all of the values so that they can be logged to the console.</p><p>If you restart your server and refresh your browser, when you start drawing on the canvas, the terminal that is running your server should be logging all of the relevant information about what is being drawn.</p><h2>Receiving Messages from the Server</h2><p>We almost have multiplayer drawing implemented. The next step is to, when the server gets a message from a client, tell all of the other clients about it so that they can use that data to draw on their own canvas.</p><p>Let&#x27;s update the server code so that we do two things:</p><p>Firstly, everytime a client connects to our server, we should store it inside of an array.</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="gatsby-highlight-code-line"><span class="token keyword">let</span> clients <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  clients<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ws<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> colour <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Client is drawing at (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) with the colour: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>colour<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>Secondly, whenever we receive a message from a client, we should send it to all of the other clients:</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">WebSocketServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ws</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;New Connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  clients<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ws<span class="token punctuation">)</span><span class="token punctuation">;</span>

  ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    clients<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">client</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>client <span class="token operator">!==</span> ws<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">        client<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>Here we&#x27;re just looping through our array of clients, and sending the message along to every client that isn&#x27;t the client that actually sent the message.</p><p>In the next section we will add a listener on the client that will react to this message by drawing it to the canvas.</p><h2>Drawing Networked Data to the Canvas</h2><p>In the <em>client/main.js</em> file (somewhere at the top-level of the file), add the following code:</p><div class="gatsby-code-title">client/main.js</div><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">socket<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>socket<span class="token punctuation">.</span>readyState <span class="token operator">===</span> WebSocket<span class="token punctuation">.</span><span class="token constant">OPEN</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> colour <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

      ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> colour<span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> thisColour<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div><p>Here we are adding a listener to our socket, first to check if it has connected to the server sucessfully, and then for if it has received a message.</p><p>We then destructure the data from the message, and then draw to the canvas using it.</p><p>That&#x27;s it!</p><p>Restart your server and refresh your browser, make sure to open two tabs (side by side if possible) and start drawing, you should see the result on both tabs at the same time!</p><h2>Housekeeping</h2><p>Right now, if a client disconnects from the server, we still store them inside of the <code class="language-text">clients</code> array in <em>server/main.js</em>. This isn&#x27;t an issue for this use case, but it is always good to clean up after ourselves.</p><p>We can do this easily as, when a websocket disconnects, it sends a &quot;close&quot; message to the server. Let&#x27;s use this to remove it from the array.</p><div class="gatsby-code-title">server/main.js</div><div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  clients <span class="token operator">=</span> clients<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">client</span> <span class="token operator">=&gt;</span> client <span class="token operator">!==</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>This just loops through the clients array, and filters it so that only the clients that aren&#x27;t our client that just disconnected are returned.</p><h2>Some things to be aware of</h2><h3>Dealing with broken connections</h3><p>Although for this simple example it doesn&#x27;t matter, sometimes the link between the server and the client can be interrupted with both of them being unaware of the broken connection. The way to combat this is to use something called a <strong>heartbeat</strong> which periodically <em>pings</em> the client and expects a <em>pong</em> in return which verifies that it is still connected (or <em>alive</em> if you prefer). You can read more on how to implement this <a href="https://github.com/websockets/ws#how-to-detect-and-close-broken-connections" target="_blank" rel="nofollow">here</a>.</p><h3>Maintaining state across connections</h3><p>Another gotcha that we didn&#x27;t account for is a client disconnecting and then reconnecting when a session has already started. In its current state nothing will break, but if any of the clients have drawn on the canvas, any new clients (or rejoining clients) won&#x27;t be shown the existing drawings.</p><p>This may or may not be your desired functionality, but a possible solution would be to store a queue of actions on the server and, every time a client sends a message, add it to the queue. Then, when a new/rejoining client connects, send them the queue so that they can draw it on their canvas but I&#x27;ll leave it up to you to implement a solution.</p><h3>Working over a secure connection (https)</h3><p>Finally, on the client we are currently connecting to the websocket server by writing <code class="language-text">ws://localhost:1234</code> and it all works as expected. However this only works as our websocket server is on an unsecure connection (<code class="language-text">http</code>). If our server was using <code class="language-text">https</code> we would need to update the url to be <code class="language-text">wss://localhost:1234</code>.</p><p>It is important to be aware of this as if you decide to host your server on something like <a href="https://heroku.com/" target="_blank" rel="nofollow">heroku</a>, it will default to <code class="language-text">https</code>.</p><h2>Conclusion</h2><p>Thanks for reading, I hope this blogpost gave you a good, practical, introduction to websockets. There is much more to them, but this should be enough to get started. If you want a more comprehensive solution to websockets, there are libraries like <a href="https://socket.io/" target="_blank" rel="nofollow">socket.io</a>.</p><p>I will be publishing another blogpost in the near future that guides you through <strong>Creating a Multiplayer Quiz Game using React and Websockets</strong> which will delve further into websockets and cover some cool stuff such as:</p><ul><li><p>Implementing a room system so that users can create and join rooms using a code</p></li><li><p>Basic cheat prevention</p></li><li><p>Maintaining game state across connections</p></li></ul><p>...and much more</p></section><section class="BlogpostEnd__Container-sc-1v5rsh7-0 bpXHJg"><p>Congrats, you made it! ðŸŽ‰</p><p>If you enjoyed this post you can read my other blog posts<!-- --> <a href="/blog">here</a> or follow me on twitter<!-- --> <a href="https://twitter.com/Pjaerr">@Pjaerr</a></p></section><section class="GithubIssueComments-container"><button class="GithubIssueComments-show-comments-button">Show Comments</button></section></article></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/introduction-to-websockets";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-26b0f76e619f0f82c78b.js"],"component---src-templates-blog-post-template-js":["/component---src-templates-blog-post-template-js-ab5ceb8031054a06af97.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e1c50d7fb4b178ee2701.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-24e270d86da7b659586e.js"],"component---src-pages-index-js":["/component---src-pages-index-js-02ec0bd1d9d59e21605c.js"]};/*]]>*/</script><script src="/webpack-runtime-d1be503a8acc3e14dd04.js" async=""></script><script src="/app-26b0f76e619f0f82c78b.js" async=""></script><script src="/framework-37b45856124a722f0eb5.js" async=""></script><script src="/a41fe35e98afd0b1499457e30a7a2f454f628b37-ca9d42fee389d0cce62e.js" async=""></script><script src="/component---src-templates-blog-post-template-js-ab5ceb8031054a06af97.js" async=""></script><script src="/styles-1bb458fe328f2ce5df8e.js" async=""></script></body></html>